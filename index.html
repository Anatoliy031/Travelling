<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Путешествуй по России</title>
  <!-- Карта Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-o3GkG3ry3GGGNkY09JEMvR2sX4Mha+2xb/n60X3qtvA="
    crossorigin=""
  />
  <style>
    /* Базовые стили и переменные */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: sans-serif;
      background: #f8f9fa;
      color: #333;
      line-height: 1.5;
    }
    :root {
      --primary: #0d6efd;
      --secondary: #ff7f00;
      --light: #fff;
      --dark: #343a40;
    }
    /* Шапка */
    header {
      background: var(--light);
      border-bottom: 1px solid #eaeaea;
      padding: 0.8rem 1rem;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .logo {
      font-weight: 700;
      color: var(--primary);
    }
    .logo span { color: var(--secondary); }
    nav ul {
      list-style: none;
      display: flex;
      gap: 1rem;
    }
    nav a {
      text-decoration: none;
      color: var(--dark);
      font-weight: 500;
    }
    nav a:hover { color: var(--primary); }
    /* Герой */
    .hero {
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: var(--light);
      text-align: center;
      padding: 4rem 1rem;
    }
    .hero h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    .hero p { margin-bottom: 1rem; }
    .btn {
      display: inline-block;
      padding: 0.6rem 1rem;
      margin: 0.3rem;
      border-radius: 4px;
      text-decoration: none;
      color: var(--light);
    }
    .btn-primary { background: var(--primary); }
    .btn-secondary { background: var(--secondary); }
    /* Разделы */
    .container { max-width: 1000px; margin: 0 auto; padding: 2rem 1rem; }
    #map { width: 100%; height: 400px; margin-bottom: 1rem; }
    .list-container, .services-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 1rem;
    }
    .card {
      background: var(--light);
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 0.8rem;
    }
    .card h3 { color: var(--primary); margin-bottom: 0.5rem; }
    .card p { font-size: 0.9rem; }
    footer {
      background: var(--dark);
      color: var(--light);
      padding: 2rem 1rem;
      margin-top: 2rem;
    }
    footer a { color: var(--secondary); text-decoration: none; }
    footer a:hover { text-decoration: underline; }
  </style>
</head>
<body>

  <header>
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <div class="logo">Путешествуй<span>.RU</span></div>
      <nav>
        <ul>
          <li><a href="#map">Карта</a></li>
          <li><a href="#list">Достопримечательности</a></li>
          <li><a href="#services">Сервисы</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="hero">
    <h1>Открой Россию</h1>
    <p>Лучшие места и приключения для путешественников</p>
    <a href="#map" class="btn btn-primary">К карте</a>
    <a href="#services" class="btn btn-secondary">Туры и приключения</a>
  </section>

  <!-- Поиск -->
  <div class="container">
    <form id="search-form" style="display:flex;gap:0.5rem;flex-wrap:wrap;">
      <input id="search-input" type="text" placeholder="Введите город (например, Москва)" style="flex:1;padding:0.5rem;border:1px solid #ccc;border-radius:4px;">
      <button type="submit" class="btn btn-primary">Искать</button>
      <button type="button" id="geo-btn" class="btn btn-secondary">Моё местоположение</button>
    </form>
    <p style="font-size:0.8rem;color:#666;margin-top:0.5rem;">Можно выбрать поиск по городу или определить своё местоположение.</p>
  </div>

  <!-- Карта -->
  <div id="map"></div>

  <!-- Список достопримечательностей -->
  <div class="container">
    <h2 id="list">Список достопримечательностей</h2>
    <div id="list-container" class="list-container"></div>
  </div>

  <!-- Сервисы -->
  <div class="container">
    <h2 id="services">Активные приключения и туры</h2>
    <div id="services-container" class="services-container"></div>
  </div>

  <!-- Подвал -->
  <footer>
    <div style="display:flex;flex-wrap:wrap;gap:2rem;">
      <div style="flex:1;">
        <h3>О проекте</h3>
        <p>Сайт создан для того, чтобы вы могли открыть для себя удивительные места России и узнать, где заказать активные туры.</p>
      </div>
      <div>
        <h3>Контакты</h3>
        <p>Пишите предложения на <a href="mailto:info@puteshestvuy.ru">info@puteshestvuy.ru</a></p>
      </div>
    </div>
    <p style="margin-top:1rem;font-size:0.8rem;">© 2025 Путешествуй.РУ</p>
  </footer>

  <!-- Библиотека карты -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-o//DsQoZdFWG1DR+jVB/YQLQYmkOZhlmkoN1Vj+2a54="
    crossorigin=""
  ></script>
  <script>
    // Статический список достопримечательностей
    const attractions = [
      { name: 'Красная площадь', city: 'Москва', lat: 55.7539, lon: 37.6208, desc: 'Исторический центр Москвы и сердца России.' },
      { name: 'Эрмитаж', city: 'Санкт-Петербург', lat: 59.9398, lon: 30.3146, desc: 'Один из крупнейших музеев искусства и культуры.' },
      { name: 'Остров Кижи', city: 'Карелия', lat: 62.0613, lon: 35.2338, desc: 'Музей под открытым небом с деревянными храмами.' },
      { name: 'Озеро Байкал', city: 'Иркутск', lat: 53.5587, lon: 108.1650, desc: 'Самое глубокое озеро на планете, «жемчужина Сибири».' },
      { name: 'Эльбрус', city: 'Кавказ', lat: 43.3499, lon: 42.4453, desc: 'Высочайшая гора Европы и популярный альпинистский объект.' },
      { name: 'Куршская коса', city: 'Калининград', lat: 55.2423, lon: 20.9106, desc: 'Уникальный национальный парк на Балтике.' },
      { name: 'Камчатские вулканы', city: 'Камчатка', lat: 53.1365, lon: 158.3711, desc: 'Грандиозный вулканический пейзаж полуострова.' },
      { name: 'Петродворец (Петергоф)', city: 'Санкт-Петербург', lat: 59.8800, lon: 29.8870, desc: 'Императорский дворец и знаменитые фонтаны.' },
      { name: 'Казанский кремль', city: 'Казань', lat: 55.7961, lon: 49.1082, desc: 'Историческая крепость и символ Татарстана.' },
      { name: 'Алтайские горы', city: 'Алтай', lat: 50.0073, lon: 86.9921, desc: 'Живописные горы, озёра и реки Горного Алтая.' }
    ];

    // Данные туроператоров
    const services = [
      { name:'RussiaDiscovery', desc:'Экспедиции и джип-туры по России.', phone:'+7 495 323-98-45', email:null, web:'https://www.russiadiscovery.ru' },
      { name:'Trophy‑Life', desc:'Джип-туры по Подмосковью и подарочные сертификаты.', phone:'+7 495 649-65-79', email:'info@trophy-life.ru', web:'https://trophy-life.ru' },
      { name:'М‑драйв Джип тур', desc:'Авторские джип-туры по Крыму.', phone:'+7 978 007-81-11', email:null, web:'https://xn----8sbgg0ao4a.xn--p1ai' },
      { name:'Турклуб ПИК', desc:'Байдарочные походы, восхождения и автотуры.', phone:'8 800 200-2456', email:null, web:'https://turclub-pik.ru' },
      { name:'Ахтилахти', desc:'Туры на байдарках, каяках и SUP вокруг Санкт-Петербурга и по России.', phone:'+7 911 701-71-51', email:'go@ahtilahti.ru', web:'https://ahtilahti.ru' },
      { name:'Adventure Guide', desc:'Сплавы на байдарках, рафтинг и другие приключения.', phone:'+7 495 197-89-23, 8 800 201-31-58, +7 953 534-25-92', email:null, web:'https://adventure-guide.ru' }
    ];

    let map, markers;

    // Инициализация карты
    function initMap() {
      map = L.map('map').setView([58.5, 50], 4);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
      }).addTo(map);
      markers = L.layerGroup().addTo(map);
      displayAttractions(attractions); // показываем все по умолчанию
    }

    // Добавление маркеров и списка
    function displayAttractions(list) {
      markers.clearLayers();
      document.getElementById('list-container').innerHTML = '';
      list.forEach(item => {
        const marker = L.marker([item.lat, item.lon]).addTo(markers);
        marker.bindPopup('<strong>' + item.name + '</strong><br>' + item.desc);
        // Карточка в списке
        const card = document.createElement('div');
        card.className = 'card';
        const title = document.createElement('h3');
        title.textContent = item.name;
        const text = document.createElement('p');
        text.textContent = item.desc;
        card.appendChild(title);
        card.appendChild(text);
        document.getElementById('list-container').appendChild(card);
      });
    }

    // Поиск по городу
    document.getElementById('search-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const query = document.getElementById('search-input').value.trim().toLowerCase();
      if (!query) { displayAttractions(attractions); return; }
      const filtered = attractions.filter(a => a.city.toLowerCase().includes(query));
      if (filtered.length) {
        // центрируем карту на первом совпадении
        map.setView([filtered[0].lat, filtered[0].lon], 6);
        displayAttractions(filtered);
      } else {
        alert('Ничего не найдено, показываем все места.');
        displayAttractions(attractions);
      }
    });

    // Геолокация
    document.getElementById('geo-btn').addEventListener('click', function() {
      if (!navigator.geolocation) {
        alert('Ваш браузер не поддерживает геолокацию');
        return;
      }
      navigator.geolocation.getCurrentPosition(function(pos) {
        const { latitude, longitude } = pos.coords;
        map.setView([latitude, longitude], 5);
        // ищем ближайшие достопримечательности (до 300 км)
        const near = attractions
          .map(a => {
            return { ...a, dist: distance(latitude, longitude, a.lat, a.lon) };
          })
          .filter(a => a.dist <= 300)
          .sort((a,b) => a.dist - b.dist);
        displayAttractions(near.length ? near : attractions);
      }, function() {
        alert('Не удалось определить местоположение');
      });
    });

    // Haversine: расстояние между двумя координатами (км)
    function distance(lat1, lon1, lat2, lon2) {
      const R = 6371;
      const dLat = toRad(lat2-lat1);
      const dLon = toRad(lon2-lon1);
      const a =
        Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
        Math.sin(dLon/2) * Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }
    function toRad(deg) { return deg * Math.PI/180; }

    // Вывод сервисов
    function displayServices() {
      const container = document.getElementById('services-container');
      services.forEach(s => {
        const card = document.createElement('div');
        card.className = 'card';
        const h = document.createElement('h3');
        h.textContent = s.name;
        const p = document.createElement('p');
        p.textContent = s.desc;
        const contact = document.createElement('p');
        contact.innerHTML = 'Тел.: ' + s.phone + (s.email ? '<br>e-mail: <a href="mailto:' + s.email + '">' + s.email + '</a>' : '') + '<br><a href="' + s.web + '" target="_blank">Сайт</a>';
        card.appendChild(h);
        card.appendChild(p);
        card.appendChild(contact);
        container.appendChild(card);
      });
    }

    // Старт
    window.addEventListener('DOMContentLoaded', function() {
      initMap();
      displayServices();
    });
  </script>
</body>
</html>
